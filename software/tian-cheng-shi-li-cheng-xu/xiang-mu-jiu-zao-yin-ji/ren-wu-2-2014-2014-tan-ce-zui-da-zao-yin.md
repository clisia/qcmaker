### 任务2——探测最大噪音

#### 1、任务目标

模拟声音传感器用来探测一段时间内噪音的最大值，用户按下按钮开关后模拟声音传感器开始工作， 只记录最大值。再次按下按钮开关停止记录，并回到初始位置。

#### 2、流程图

思路解析：

![图3.9-5](/assets/image326.jpg)

如何使按键随时改变工作状态——**中断函数。**

在这个程序中，我们主要需要用一个 state变量来判断工作状态，若 state 值为1(即开) 各部分按要求工作，若 state值为0(即关)则所有部分归零;其次，在工作过程中我们还 需随时检测按键有没有被按下以改变state的值;噪音计和舵机的工作状态与按键状态是 两个可以独立运行的部分(没有什么明显的逻辑关系语句可以把两个部分建立联系)，因此，我们考虑用中断函数，即在工作或停止工作过程中随时检测按键状态(在用按键控制复杂的元件的开关状态时经常使用中断函数)。

#### 3、程序编程

![图3.9-6](/assets/image328.jpg)

#### 4、硬件连接

硬件连接： 舵机——9；按钮——2；模拟声音传感器——A0。注意插线时的颜色对应。

![图3.9-7](/assets/image330.jpg)

#### 5、Q&A

Q：按下按钮开关后，舵机没有开始摆动或摆动角度很小？

A：模拟传感器的输入值较小，此时可以修改映射的输出范围；

#### 6、拓展

1、知识点总结

1）“舵机”程序块与“映射”、“模拟输入”程序块的结合使用；

2）条件结构；

3）变量的使用；

2、相关案例

1）本项目的任务1；

2）项目五的任务2；

